<div class="container rounded py-2 px-4 bg-light position-relative">
  <div
    *ngIf="loading"
    class="row position-fixed mmodal justify-content-center align-items-center"
  >
    <app-loading></app-loading>
  </div>

  <div class="row mb-3 justify-content-end" *ngIf="!create">
    <button (click)="sendMail()" class="col-auto btn btn-primary mx-3">
      <i class="fa fa-envelope fa-1x checked  mr-1"></i>
      Envoyer un Mail
    </button>
    <button (click)="cancelDemand()" class="col-auto btn btn-danger">
      <i class="fa fa-trash fa-1x checked  mr-1"></i>
      Supprimer la demande
    </button>
  </div>
  <hr class="row my-3" *ngIf="!create" />

  <div class="row justify-content-center">
    <div class="col-auto d-flex status  m-2 align-items-center">
      <div
        [ngClass]="{
          'p-2 status-info': true,
          current: workflow.status == 'Brouillon',
          previous: workflow.status !== 'Brouillon'
        }"
      >
        <i class="fa fa-check-circle fa-1x checked  mr-1"></i>
        <i class="fas fa-check-double fa-1x checked  mr-1"></i>
        Demande Brouillon
      </div>
      <div class="arrow "></div>
    </div>
    <div class="col-auto d-flex status m-2 opac">
      <div
        [ngClass]="{
          'p-2 status-info': true,
          current: workflow.status == 'En Attente',
          previous: workflow.status == 'Traitee',
          next: workflow.status == 'Brouillon'
        }"
      >
        <i class="fa fa-check-circle fa-1x checked  mr-1"></i>
        <i class="fas fa-check-double fa-1x checked  mr-1"></i>
        Demande En Attente
      </div>
      <div class="arrow "></div>
    </div>
    <div class="col-auto d-flex status m-2">
      <div
        [ngClass]="{
          'p-2 status-info': true,
          next: workflow.status !== 'Traitee',
          previous: workflow.status == 'Traitee'
        }"
      >
        <i class="fa fa-check-circle fa-1x checked  mr-1"></i>
        <i class="fas fa-check-double fa-1x checked  mr-1"></i>
        Demande Trait√©e
      </div>
      <div class="arrow "></div>
    </div>
  </div>
  <div class="row   mb-4">
    <h4 class="h4 m-2">Demande N 10</h4>
  </div>
  <div class="row my-2">
    <div class="col-auto my-2  ">
      Demandeur
    </div>
    <div class="col-auto">
      <input
        [readonly]="workflow.status != 'Brouillon'"
        type="text"
        [(ngModel)]="workflow.demandeur.organisation"
        class="form-control rounded-input my-2"
        placeholder="Organisation"
      />
      <input
        [readonly]="workflow.status != 'Brouillon'"
        type="text"
        [(ngModel)]="workflow.demandeur.email"
        class="form-control rounded-input my-2"
        placeholder="Email"
      />
      <input
        [readonly]="workflow.status != 'Brouillon'"
        type="text"
        [(ngModel)]="workflow.demandeur.pays"
        class="form-control rounded-input my-2"
        placeholder="Pays"
      />
      <input
        [readonly]="workflow.status != 'Brouillon'"
        type="text"
        [(ngModel)]="workflow.demandeur.ville"
        class="form-control rounded-input my-2"
        placeholder="Ville"
      />
    </div>
    <div class="col"></div>
    <div class="col-auto">
      <div class="form-group row align-items-center">
        <label for="inputEmail3" class="col-sm-4 col-form-label"
          >Date du Demande</label
        >
        <div class="col-sm-8">
          <input
            [readonly]="workflow.status != 'Brouillon'"
            type="date"
            [ngModel]="workflow.dateDemande | date: 'yyyy-MM-dd'"
            (ngModelChange)="workflow.dateDemande = $event"
            class="form-control rounded-input  rounded-input"
            id="inputEmail3"
            placeholder="Email"
          />
        </div>
      </div>
      <div class="form-group row align-items-center">
        <label for="inputPassword3" class="col-sm-4 col-form-label "
          >Type Permis</label
        >
        <div class="col-sm-8 ">
          <select
            [disabled]="workflow.status != 'Brouillon'"
            name=""
            id=""
            [(ngModel)]="workflow.typePermis"
            class="form-control rounded-input"
          >
            <option value="1">Option 1</option>
            <option value="2">Option 2</option>
            <option value="3">Option 3</option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4 mb-1 justify-content-end">
    <button
      [disabled]="
        !workflow.demandeur.organisation ||
        !workflow.demandeur.email ||
        !workflow.demandeur.pays ||
        !workflow.demandeur.ville ||
        loading
      "
      (click)="sauvegarderBrouillon()"
      class="action mx-2 btn btn-primary"
      *ngIf="create"
    >
      <i class="fa fa-check fa-1x checked  mr-1 "></i>
      Sauvegarder Brouillon
    </button>
    <button
      *ngIf="create"
      [disabled]="loading"
      (click)="cancel()"
      class="action mx-2 btn btn-danger"
    >
      <i class="fa fa-times-circle  fa-1x    mr-1 "></i>
      Annuler
    </button>
    <button
      [disabled]="
        !workflow.demandeur.organisation ||
        !workflow.demandeur.email ||
        !workflow.demandeur.pays ||
        !workflow.demandeur.ville ||
        loading
      "
      *ngIf="!create"
      (click)="mettreEnAttente()"
      class="action mx-2 btn btn-primary"
    >
      <i class="fa fa-check fa-1x checked  mr-1 "></i>
      Mettre En Attente
    </button>
    <div *ngIf="!create">
      <button (click)="autoriser()" class="action mx-2 btn btn-success">
        <i class="fas fa-check-double fa-1x checked  mr-1"></i>
        Autoriser
      </button>

      <button (click)="reject()" class="action mx-2 btn btn-danger">
        <i class="fas fa-times-circle fa-1x checked  mr-1"></i>
        Refuser
      </button>
    </div>
  </div>
</div>
